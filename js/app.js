!function(e){"use strict";var n=function(){function o(){p=new google.maps.Map($(".map").get(0),{center:{lat:37.386052,lng:-122.083851},zoom:14}),ko.applyBindings(n)}function t(){ko.applyBindings(n),f("<h1>Google Map error!!!</h1><p>Something went wrong with the Google map API request.\nPlease refresh your browser ,try again letter or check your internet connection.</p>"),d(!1)}function r(e){u="https://api.foursquare.com/v2/venues/explore?near=Mountain View, CA&query=pizza&limit=10&oauth_token=50XUH2ZKED4X4GSRF4EOR0LW4EF0R1IUC1USVIABIYXEMXP5&v=20160321";var n=$.ajax({url:u,dataType:"jsonp"});n.done(function(n){e(n)}),n.fail(function(e,n,o){f("<h1>Oops!!! "+e.status+" error</h1><p>Something went wrong with the foursquare API request.\nPlease refresh your browser ,try again letter or check your internet connection.</p>"),d(!1)})}function a(n){var o=n.response.groups[0].items,t=new google.maps.LatLngBounds,r=new google.maps.InfoWindow,a="https://foursquare.com/v/";o.forEach(function(e,n){c.push({tip:e.tips[0].text,name:e.venue.name,phone:e.venue.contact.formattedPhone,twitter:e.venue.contact.twitter,address:e.venue.location.formattedAddress[0],rating:e.venue.rating,url:a+e.venue.id,lat:e.venue.location.lat,lng:e.venue.location.lng,marker:new google.maps.Marker({position:{lat:e.venue.location.lat,lng:e.venue.location.lng},title:e.venue.name,animation:google.maps.Animation.DROP,map:p,draggable:!1})}),t.extend(c()[n].marker.getPosition())}),p.fitBounds(t),google.maps.event.addDomListener(e,"resize",function(){var e=p.getCenter();google.maps.event.trigger(p,"resize"),p.panTo(e),p.fitBounds(t)}),ko.utils.arrayForEach(c(),function(e){google.maps.event.addListener(e.marker,"click",function(){s&&s!==e.marker&&s.setAnimation(null),r&&r.close(),g(e),e.marker.setAnimation(google.maps.Animation.BOUNCE),s=e.marker;var n="<div><h1>"+e.name+'</h1><p class="tip">'+e.tip+'</p><ul><li><span class="bold-text">RATING:</span> '+e.rating+'</li><li><span class="bold-text">ADDRESS:</span> '+e.address+'</li><li><span class="bold-text">TEL:</span> '+e.phone+'</li><li><a href="'+e.url+'" target="_blank">View on Foursquare</li></div></ul>';r.setContent(n),r.marker=e.marker,r.open(p,e.marker),p.panTo(e.marker.getPosition())})}),google.maps.event.addListener(r,"closeclick",function(){r.marker.setAnimation(null)})}function i(e){g(e),google.maps.event.trigger(g().marker,"click")}var s,l,u,p,c=ko.observableArray(),g=ko.observable(""),m=ko.observable(""),d=ko.observable(!0),f=ko.observable();return r(a),l=ko.computed(function(){var e=[],n=[];return ko.utils.arrayFilter(c(),function(o){return o.name.toLowerCase().indexOf(m().toLowerCase())<0?(e.push(o),void e.forEach(function(e){e.marker.setMap(null)})):(n.push(o),n.forEach(function(e){e.marker.setMap(p)}),0===m().length||o.name.toLowerCase().indexOf(m().toLowerCase())>-1)})}),{searched:l,chosenPlace:g,placeClick:i,query:m,initMap:o,apiError:d,errorMessage:f,googleError:t}}();e.NeighborhoodMap=n}(window);